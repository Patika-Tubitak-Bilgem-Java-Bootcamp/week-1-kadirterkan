-- 1
SELECT * FROM FILM
    WHERE TITLE LIKE 'K%'
    ORDER BY LENGTH DESC, REPLACEMENT_COST ASC;

-- 2
SELECT RATING FROM FILM GROUP BY RATING ORDER BY COUNT(*) DESC LIMIT 1;

-- 3
SELECT FIRST_NAME FROM CUSTOMER
    INNER JOIN PAYMENT
        ON PAYMENT.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
    GROUP BY CUSTOMER.CUSTOMER_ID
        ORDER BY COUNT(*) DESC LIMIT 1;

-- 4
SELECT CATEGORY.NAME, COUNT(*) FROM FILM_CATEGORY
    INNER JOIN CATEGORY
        ON CATEGORY.CATEGORY_ID = FILM_CATEGORY.CATEGORY_ID
    INNER JOIN FILM
        ON FILM.FILM_ID = FILM_CATEGORY.FILM_ID
        GROUP BY CATEGORY.NAME
        ORDER BY COUNT(*);

-- 5
SELECT COUNT(*) FROM FILM
    WHERE TITLE ILIKE '%E%E%E%E%';